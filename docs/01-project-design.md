# 프로젝트 설계

## 1. 서비스 설명

사이트에 방문한 사람이 한 줄의 다짐을 적어 방문한 사람들과 다짐을 공유하는 서비스.

## 2. 전체 흐름

1. **사용자 접속:** 사용자가 웹 브라우저를 통해 프론트엔드(Next.js) 서버에 접속.
2. **데이터 조회 요청:** 접속과 동시에 프론트엔드는 백엔드(Spring Boot) API 서버에 '저장된 다짐 목록'을 요청(`GET`).
3. **데이터 조회 및 반환:** 백엔드는 데이터베이스(MySQL)에서 데이터를 꺼내와 프론트엔드에 전달하고, 사용자는 화면에서 다짐 목록을 확인.
4. **다짐 등록:** 사용자가 작성자 이름과 내용을 입력하고 '등록' 버튼을 클릭.
5. **데이터 저장 요청:** 프론트엔드는 입력된 데이터를 JSON 형태로 백엔드 API 서버에 전송(`POST`).
6. **영구 저장:** 백엔드는 데이터를 검증한 뒤 데이터베이스에 영구적으로 저장하고, 성공 결과를 반환.

## 3. 프론트엔드 역할

- **기술 스택:** Next.js (Node.js 20)
- **주요 책임:**
  - 사용자에게 UI를 제공.
  - `fetch` API를 사용하여 백엔드 서버와 비동기 통신을 담당합니다.
  - 환경 변수(`.env`)를 활용하여 로컬 개발 환경과 배포 환경(EC2)의 API 주소를 동적으로 관리.
  - Docker Multi-stage 빌드를 통해 배포 용량을 최적화.

## 4. 백엔드 역할

- **기술 스택:** Spring Boot, Spring Data JPA
- **주요 책임:**
  - RESTful API 엔드포인트(`GET /api/guestbooks`, `POST /api/guestbooks`)를 제공.
  - CORS 설정을 통해 프론트엔드의 접근을 허용.
  - 비즈니스 로직을 처리하고, MySQL 데이터베이스와 직접 통신하여 데이터의 생성(Create)과 조회(Read)를 수행.
  - 오류 발생 시 적절한 HTTP 상태 코드와 메시지를 반환.

## 5. 배포 구조 요약

- **인프라:** AWS EC2 (Linux/Amazon Linux 2023)
- **컨테이너 관리:** Docker & Docker Compose
  - **로컬 환경:** 개발자의 PC(`localhost`)에서 개별적으로 실행하거나 테스트.
  - **배포 환경:** EC2 서버 내에서 `docker-compose`를 통해 Frontend, Backend, MySQL 컨테이너가 하나의 내부 네트워크로 묶여 실행.
  - **네트워크:** 컨테이너 내부 통신은 서비스 명(`mysql`, `backend`)을 사용하고 외부 접속은 포트 포워딩(`3000`, `8080`)을 통해 처리.
- **자동화 (CI/CD):** GitHub Actions를 구축하여, 코드가 `main` 브랜치에 푸시되면 자동으로 서버에 접속해 최신 코드를 배포.

### 로컬 환경 vs 배포 환경 차이점

| 구분              | 로컬 개발 환경 (Local)         | 배포 운영 환경 (Production)             |
| :---------------- | :----------------------------- | :-------------------------------------- |
| **실행 주체**     | 개발자의 개인 PC (Windows/Mac) | AWS EC2 클라우드 서버 (Linux)           |
| **접속 주소**     | `http://localhost:3000`        | `http://{EC2_Public_IP}:3000`           |
| **API 호출 주소** | `http://localhost:8080`        | `http://{EC2_Public_IP}:8080`           |
| **DB 연결 방식**  | `localhost:3306` (외부 포트)   | `jdbc:mysql://mysql:3306` (도커 내부망) |
| **배포 방식**     | 코드 수정 시 즉시 반영         | GitHub Actions를 통한 CI/CD 자동 배포   |
| **네트워크**      | 호스트 네트워크 직접 사용      | Docker Bridge Network (서비스명 통신)   |
